<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Menstrual Health Education</title>    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/common-sidebar.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>        :root {
            --bg-color: #FFF9F9;
            --sidebar-color: #F9F5FF;
            --text-dark: #4A4A4A;
            --text-light: #8A7FAA;
            --accent-pink: #FFD6E0;
            --accent-peach: #FFE8D6;
            --accent-teal: #C1EDE6;
            --accent-lavender: #E8E0FF;
            --graph-pink: #FFB8D1;
            --graph-lavender: #B8B3FF;
            --primary-purple: #6E5B9A;
            
            /* Standardized sidebar font sizes - REQUIRED for consistent sidebar */
            --sidebar-logo-size: 24px;
            --sidebar-nav-size: 16px;
            --sidebar-dropdown-size: 14px;
            --sidebar-emoji-size: 16px;
            --sidebar-dropdown-emoji-size: 14px;
            
            /* Education-specific colors */
            --pink-light: #FFE8F5;
            --pink-medium: #FFC2E2;
            --pink-dark: #FF8EC7;
            --purple-light: #F0E6FF;
            --purple-medium: #D9C2FF;
            --purple-dark: #B28CFF;
            --cream: #FFF9F0;
        }* {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }        body {
            background-color: var(--bg-color);
            color: var(--text-dark);
            display: flex;
            min-height: 100vh;
            margin: 0;
            padding: 0;
        }
        
        /* Override sidebar text to match dashboard font weight */
        .nav-item {
            font-weight: normal !important;
        }
        
        .nav-item span {
            font-weight: normal !important;
        }
        
        .dropdown-item {
            font-weight: normal !important;
        }
        
        .dropdown-item span {
            font-weight: normal !important;
        }
        
        .profile-name {
            font-weight: 600 !important;
        }
        
        /* Keep logo text at its default weight */
        .logo span {
            font-weight: 700 !important;
        }

        .main-content {
            padding: 20px;
            max-width: none;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            color: var(--text-dark);
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .header p {
            color: var(--text-light);
            font-size: 1.1rem;
        }

        .section {
            background-color: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 25px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }

        .section-title {
            font-size: 1.4rem;
            margin-bottom: 15px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Timeline Styles */
        .timeline-container {
            overflow-x: auto;
            padding-bottom: 0;
            /* Add extra space below the timeline to prevent hover cut-off */
            box-shadow: 0 6px 16px -8px rgba(255, 140, 199, 0.10);
            border-radius: 0 0 16px 16px;
        }
        .timeline {
            display: flex;
            gap: 15px;
            min-width: 700px;
            padding-bottom: 0; /* Remove bottom padding */
        }
        .phase {
            background-color: var(--pink-light);
            border-radius: 12px;
            padding: 15px;
            width: 160px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4,0,0.2,1);
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(255, 140, 199, 0.08);
            border: 2px solid transparent;
            position: relative;
            z-index: 1;
            margin-bottom: 0;
        }
        .phase:hover, .phase.active {
            background-color: var(--pink-medium);
            border: 2px solid var(--pink-dark);
            box-shadow: 0 8px 24px 0 rgba(255, 140, 199, 0.18), 0 2px 8px rgba(255, 140, 199, 0.08);
            z-index: 10;
            transform: none;
        }
        .phase.active {
            background-color: var(--pink-dark);
            color: white;
        }
        /* Popup Modal Styles */
        .modal-phase-bg {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0; top: 0; right: 0; bottom: 0;
            width: 100vw; height: 100vh;
            background: rgba(80, 30, 80, 0.18);
            justify-content: center;
            align-items: center;
        }
        .modal-phase-bg.active {
            display: flex;
        }
        .modal-phase {
            background: #fff;
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(178, 140, 255, 0.18);
            padding: 36px 32px 28px 32px;
            min-width: 320px;
            max-width: 95vw;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: fadeIn 0.3s;
        }
        .modal-phase .close-btn {
            position: absolute;
            top: 18px;
            right: 18px;
            background: var(--pink-light);
            border: none;
            border-radius: 50%;
            width: 36px;
            height: 36px;
            font-size: 1.3rem;
            color: var(--pink-dark);
            cursor: pointer;
            transition: background 0.2s;
        }
        .modal-phase .close-btn:hover {
            background: var(--pink-medium);
        }
        .phase-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .phase-name {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .phase-days {
            font-size: 0.9rem;
            color: var(--text-light);
        }

        .phase.active .phase-days {
            color: rgba(255, 255, 255, 0.8);
        }

        .phase-details {
            display: none;
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid var(--pink-medium);
            animation: fadeIn 0.4s;
        }

        .phase-details.active {
            display: block;
        }

        .phase-details h3 {
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .phase-details p {
            margin-bottom: 10px;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .phase-details ul {
            margin-left: 20px;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: none; }
        }

        /* Accordion Styles */
        .accordion-item {
            margin-bottom: 10px;
            border-radius: 12px;
            overflow: hidden;
            background-color: var(--purple-light);
        }

        .accordion-header {
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            font-weight: 500;
        }

        .accordion-header:hover {
            background-color: var(--purple-medium);
        }

        .accordion-content {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
            background-color: white;
        }

        .accordion-content-inner {
            padding: 15px 0;
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .accordion-item.active .accordion-content {
            max-height: 500px;
        }

        .accordion-icon {
            transition: transform 0.3s ease;
        }

        .accordion-item.active .accordion-icon {
            transform: rotate(180deg);
        }

        /* Carousel Styles */
        .carousel {
            position: relative;
            height: 200px;
            overflow: hidden;
            border-radius: 12px;
        }

        .carousel-inner {
            display: flex;
            transition: transform 0.5s ease;
            height: 100%;
        }

        .carousel-item {
            min-width: 100%;
            padding: 30px;
            background-color: var(--pink-light);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .carousel-item h3 {
            margin-bottom: 15px;
            color: var(--text-dark);
        }

        .carousel-item p {
            color: var(--text-light);
            max-width: 80%;
        }

        .carousel-control {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background-color: rgba(255, 255, 255, 0.7);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 10;
            font-size: 1.2rem;
            color: var(--text-dark);
        }

        .carousel-control.prev {
            left: 15px;
        }

        .carousel-control.next {
            right: 15px;
        }

        /* Symptom Tracker Styles - Enhanced */
        .tracker-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px 32px;
            background: var(--purple-light);
            border-radius: 16px;
            padding: 32px 24px 16px 24px;
            box-shadow: 0 2px 12px rgba(178, 140, 255, 0.08);
            margin-bottom: 0;
        }

        .form-group {
            margin-bottom: 0;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 1.08rem;
        }

        .radio-group {
            display: flex;
            gap: 15px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            gap: 5px;
            background: var(--pink-light);
            border-radius: 8px;
            padding: 6px 12px;
            font-size: 1.01rem;
            transition: background 0.2s;
        }

        .radio-option input:checked + span {
            color: var(--pink-dark);
            font-weight: 700;
        }

        .radio-option input {
            accent-color: var(--pink-dark);
        }

        select, textarea {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1.5px solid var(--purple-medium);
            background-color: #fff;
            color: var(--text-dark);
            font-size: 1.01rem;
        }

        .slider-container {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .slider {
            flex-grow: 1;
            -webkit-appearance: none;
            appearance: none;
            height: 8px;
            border-radius: 4px;
            background: var(--purple-medium);
            outline: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: var(--pink-dark);
            cursor: pointer;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(255, 140, 199, 0.15);
        }

        .slider-value {
            width: 36px;
            text-align: center;
            font-weight: 600;
            color: var(--pink-dark);
            font-size: 1.1rem;
        }

        .tracker-button {
            background: linear-gradient(90deg, var(--pink-dark), var(--purple-medium));
            color: white;
            border: none;
            padding: 14px 0;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1.1rem;
            transition: background 0.3s;
            grid-column: span 2;
            box-shadow: 0 2px 8px rgba(178, 140, 255, 0.10);
        }

        .tracker-button:hover {
            background: linear-gradient(90deg, var(--purple-dark), var(--pink-dark));
        }

        .tracker-summary {
            margin-top: 20px;
            padding: 18px 24px;
            background: var(--purple-light);
            border-radius: 14px;
            box-shadow: 0 2px 8px rgba(178, 140, 255, 0.08);
            display: none;
            font-size: 1.08rem;
        }

        .tracker-summary h3 {
            margin-bottom: 10px;
            color: var(--text-dark);
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }

        .summary-label {
            font-weight: 600;
            color: var(--text-dark);
        }

        .summary-value {
            color: var(--text-light);
        }

        .emoji-large {
            font-size: 2.1rem;
            margin-right: 8px;
        }

        @media (max-width: 900px) {
            .tracker-form {
                grid-template-columns: 1fr;
                padding: 18px 8px 8px 8px;
            }
            .tracker-button {
                grid-column: span 1;
            }
        }        /* PCOS Section Styles */
        .pcos-section-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 25px;
        }

        .pcos-chart-container {
            background: var(--purple-light);
            border-radius: 16px;
            padding: 24px;
        }

        .pcos-survey-container {
            background: var(--pink-light);
            border-radius: 16px;
            padding: 24px;
            max-height: 600px;
            overflow-y: auto;
        }

        .pcos-survey-form {
            margin-top: 15px;
        }

        .pcos-form-group {
            margin-bottom: 15px;
        }

        .pcos-form-label {
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 8px;
            display: block;
            font-size: 14px;
        }

        .pcos-form-control, .pcos-form-select {
            border: 2px solid var(--purple-medium);
            border-radius: 8px;
            padding: 8px 12px;
            background-color: rgba(255, 255, 255, 0.9);
            transition: all 0.3s ease;
            width: 100%;
            font-size: 14px;
        }

        .pcos-form-control:focus, .pcos-form-select:focus {
            border-color: var(--pink-dark);
            outline: none;
            box-shadow: 0 0 0 3px rgba(255, 140, 199, 0.2);
        }

        .pcos-form-check {
            margin-bottom: 8px;
        }

        .pcos-form-check-input {
            width: 16px;
            height: 16px;
            border: 2px solid var(--purple-medium);
            margin-right: 8px;
            accent-color: var(--pink-dark);
        }

        .pcos-form-check-label {
            font-size: 13px;
            color: var(--text-dark);
        }

        .pcos-submit-btn {
            background: linear-gradient(90deg, var(--pink-dark), var(--purple-medium));
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
            margin-top: 15px;
        }

        .pcos-submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 140, 199, 0.3);
        }

        .survey-status {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: 500;
        }

        .survey-completed {
            background: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            border: 1px solid rgba(76, 175, 80, 0.3);
        }

        .survey-pending {
            background: rgba(255, 193, 7, 0.1);
            color: #FF8F00;
            border: 1px solid rgba(255, 193, 7, 0.3);
        }

        .pcos-info-container {
            background: var(--cream);
            border-radius: 16px;
            padding: 24px;
            margin-top: 30px;
        }

        .pcos-survey-link {
            background: linear-gradient(90deg, var(--pink-dark), var(--purple-medium));
            color: white;
            padding: 12px 24px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: 600;
            display: inline-block;
            transition: transform 0.2s;
        }

        .pcos-survey-link:hover {
            transform: translateY(-2px);
            color: white;
            text-decoration: none;
        }        @media (max-width: 768px) {
            .tracker-form {
                grid-template-columns: 1fr;
            }
            
            .tracker-button {
                grid-column: span 1;
            }

            .pcos-section-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .pcos-survey-container {
                max-height: none;
                overflow-y: visible;
            }
            
            .main-content {
                margin-left: 70px;
                width: calc(100% - 70px);
                padding: 15px;
            }
        }

        @media (max-width: 480px) {
            .main-content {
                margin-left: 0;
                width: 100%;
                padding: 15px;
            }
        }    </style>
</head>
<body class="sidebar-layout">
    <!-- Common Sidebar -->
    {% include 'includes/sidebar.html' %}
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="header">
        <h1>Menstrual Health Education</h1>
        <p>Understand your body better and stay confident through every phase of your cycle 💖</p>
    </div>

    <div class="section" id="symptom-logs-charts">
        <h2 class="section-title">📈 Symptom Logs Overview</h2>
        <div style="display: flex; flex-wrap: wrap; gap: 32px; justify-content: center;">
            <div style="flex:1; min-width:320px; max-width:480px;">
                <h4 style="text-align:center; color:var(--primary-purple); margin-bottom:8px;">Weekly Symptom Log</h4>
                <canvas id="weeklySymptomChart" width="400" height="220"></canvas>
            </div>
            <div style="flex:1; min-width:320px; max-width:480px;">
                <h4 style="text-align:center; color:var(--primary-purple); margin-bottom:8px;">Monthly Symptom Log</h4>
                <canvas id="monthlySymptomChart" width="400" height="220"></canvas>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">🌸 Your Cycle Timeline</h2>
        <div class="timeline-container">
            <div class="timeline">
                <div class="phase" onclick="openPhaseModal(0)">
                    <div class="phase-icon">🩸</div>
                    <div class="phase-name">Menstrual</div>
                    <div class="phase-days">Days 1–5</div>
                </div>
                <div class="phase" onclick="openPhaseModal(1)">
                    <div class="phase-icon">🌱</div>
                    <div class="phase-name">Follicular</div>
                    <div class="phase-days">Days 6–13</div>
                </div>
                <div class="phase" onclick="openPhaseModal(2)">
                    <div class="phase-icon">🥚</div>
                    <div class="phase-name">Ovulation</div>
                    <div class="phase-days">Day 14</div>
                </div>
                <div class="phase" onclick="openPhaseModal(3)">
                    <div class="phase-icon">🌕</div>
                    <div class="phase-name">Luteal</div>
                    <div class="phase-days">Days 15–28</div>
                </div>
            </div>
        </div>

        <!-- Modal for Phase Details -->
        <div class="modal-phase-bg" id="phase-modal-bg">
            <div class="modal-phase" id="phase-modal-content">
                <button class="close-btn" onclick="closePhaseModal()">&times;</button>
                <div id="phase-modal-body"></div>
            </div>
        </div>

        <!-- Remove old inline phase-details -->
        <!--
        <div class="phase-details" id="menstrual-details">...</div>
        <div class="phase-details" id="follicular-details">...</div>
        <div class="phase-details" id="ovulation-details">...</div>
        <div class="phase-details" id="luteal-details">...</div>
        -->
    </div>

    <div class="section">
        <h2 class="section-title">📚 Educational Resources</h2>
        <div class="accordion">
            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>✅ How to Apply a Sanitary Napkin</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🧼</span> Wash your hands before handling the pad.</li>
                            <li><span class="emoji-large">📦</span> Remove the pad from its packaging and unfold it.</li>
                            <li><span class="emoji-large">🔖</span> Peel off the adhesive backing (usually a long strip).</li>
                            <li><span class="emoji-large">🩲</span> Center the pad in your underwear with the adhesive side down.</li>
                            <li><span class="emoji-large">🤲</span> Press firmly along the length of the pad to secure it to your underwear.</li>
                            <li><span class="emoji-large">⬅️➡️</span> Make sure the wider part of the pad is at the back.</li>
                            <li><span class="emoji-large">🦋</span> If your pad has wings, peel off the backing and wrap them around the sides of your underwear for extra security.</li>
                        </ol>
                        <p style="color:var(--pink-dark);font-weight:600;">Tip: Change your pad every 4-6 hours for comfort and hygiene.</p>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🗑️ How to Dispose of a Sanitary Napkin Properly</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🧻</span> Wrap the used pad in its original wrapper or toilet paper.</li>
                            <li><span class="emoji-large">🛍️</span> Use a disposal bag if available for extra discretion.</li>
                            <li><span class="emoji-large">🗑️</span> Place it in a designated sanitary disposal bin (found in most public restrooms).</li>
                            <li><span class="emoji-large">🏠</span> If no disposal bin is available, wrap securely and place in a trash can at home.</li>
                            <li><span class="emoji-large">🚫</span> <b>Never flush pads down the toilet!</b> They can cause plumbing blockages.</li>
                            <li><span class="emoji-large">🧴</span> Wash your hands after disposal.</li>
                        </ol>
                        <p style="color:var(--pink-dark);font-weight:600;">Tip: Use a small trash can with a lid in your bathroom to control odor.</p>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🔍 Common Vaginal Infections</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🍞</span> <b>Yeast Infection:</b> Thick, white discharge, itching, burning, redness.</li>
                            <li><span class="emoji-large">🐟</span> <b>Bacterial Vaginosis:</b> Thin, grayish-white discharge, fishy odor, mild irritation.</li>
                            <li><span class="emoji-large">💧</span> <b>UTI:</b> Burning when urinating, frequent urge, cloudy urine, pelvic pain.</li>
                        </ul>
                        <p style="margin-top:10px;"><b>Prevention Tips:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🩲</span> Wear cotton underwear</li>
                            <li><span class="emoji-large">🚫</span> Avoid douching</li>
                            <li><span class="emoji-large">➡️</span> Wipe front to back</li>
                            <li><span class="emoji-large">👖</span> Change out of wet clothes promptly</li>
                            <li><span class="emoji-large">🛡️</span> Practice safe sex</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>❤️ Consent and Safe Sex (basic overview)</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🤝</span> <b>Consent must be freely given</b> – no pressure or manipulation.</li>
                            <li><span class="emoji-large">💡</span> <b>Be informed</b> – everyone understands what they're agreeing to.</li>
                            <li><span class="emoji-large">🎉</span> <b>Look for enthusiasm</b> – a clear, happy "yes!"</li>
                            <li><span class="emoji-large">⏪</span> <b>Consent can be withdrawn</b> at any time.</li>
                            <li><span class="emoji-large">🔄</span> <b>Consent is specific</b> – agreeing to one thing doesn't mean agreeing to everything.</li>
                        </ol>
                        <p style="margin-top:10px;"><b>Safe Sex Practices:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🧑‍⚕️</span> Use condoms to prevent STIs and pregnancy</li>
                            <li><span class="emoji-large">🩺</span> Get regular STI testing if sexually active</li>
                            <li><span class="emoji-large">💬</span> Discuss sexual health with partners</li>
                            <li><span class="emoji-large">💊</span> Consider additional birth control if needed</li>
                            <li><span class="emoji-large">👄</span> Some STIs can spread through oral sex</li>
                        </ul>
                        <p style="margin-top:10px;"><b>Period Sex:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">✅</span> It's healthy if all are comfortable</li>
                            <li><span class="emoji-large">🛡️</span> Use protection (STI risk still exists)</li>
                            <li><span class="emoji-large">🧻</span> Put down a towel for easier cleanup</li>
                            <li><span class="emoji-large">🚿</span> Shower before/after if desired</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🧼 Hygiene During Periods</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🧼</span> Wash your hands before and after changing period products.</li>
                            <li><span class="emoji-large">⏰</span> Change your pad/tampon every 4-6 hours (more often if heavy flow).</li>
                            <li><span class="emoji-large">🚿</span> Clean the genital area with warm water (avoid harsh soaps inside the vagina).</li>
                            <li><span class="emoji-large">🩲</span> Wear clean, breathable cotton underwear.</li>
                            <li><span class="emoji-large">🛁</span> Shower regularly during your period.</li>
                        </ol>
                        <p style="margin-top:10px;"><b>Tampon Safety:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">⏳</span> Never wear a tampon for more than 8 hours</li>
                            <li><span class="emoji-large">💧</span> Use the lowest absorbency needed for your flow</li>
                            <li><span class="emoji-large">🔄</span> Alternate between tampons and pads if possible</li>
                            <li><span class="emoji-large">⚠️</span> Be aware of Toxic Shock Syndrome (TSS) symptoms</li>
                        </ul>
                        <p style="margin-top:10px;"><b>Menstrual Cup Care:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🫧</span> Sterilize your cup before first use and after each period</li>
                            <li><span class="emoji-large">🧼</span> Wash hands before insertion/removal</li>
                            <li><span class="emoji-large">⏰</span> Empty every 8-12 hours</li>
                            <li><span class="emoji-large">🧴</span> Clean with mild, unscented soap between uses</li>
                        </ul>
                        <p style="margin-top:10px;"><b>Odor Control:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🔄</span> Change products regularly to prevent odor</li>
                            <li><span class="emoji-large">🚫</span> Avoid scented products which can cause irritation</li>
                            <li><span class="emoji-large">💧</span> Stay hydrated to help flush out bacteria</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🩸 How to Use a Tampon</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🧼</span> Wash your hands and unwrap the tampon.</li>
                            <li><span class="emoji-large">🧍‍♀️</span> Find a comfortable position (standing, sitting, or squatting).</li>
                            <li><span class="emoji-large">👉</span> Hold the tampon applicator (or tampon) and gently insert it into your vagina, aiming towards your lower back.</li>
                            <li><span class="emoji-large">➡️</span> Push the inner tube of the applicator to insert the tampon fully, then remove the applicator.</li>
                            <li><span class="emoji-large">🧵</span> The string should hang outside for easy removal.</li>
                            <li><span class="emoji-large">⏰</span> Change every 4-8 hours. Never leave a tampon in for more than 8 hours.</li>
                        </ol>
                        <p style="color:var(--pink-dark);font-weight:600;">Tip: If it feels uncomfortable, it may not be in far enough. Remove and try again gently.</p>
                    </div>
                </div>
            </div>
            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🥣 How to Use a Menstrual Cup</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <ol style="padding-left: 18px;">
                            <li><span class="emoji-large">🧼</span> Wash your hands and sterilize the cup before use.</li>
                            <li><span class="emoji-large">🫳</span> Fold the cup (C-fold or punch-down fold).</li>
                            <li><span class="emoji-large">🧍‍♀️</span> Find a comfortable position and gently insert the folded cup into your vagina.</li>
                            <li><span class="emoji-large">🔄</span> Let it open fully and rotate slightly to ensure a seal.</li>
                            <li><span class="emoji-large">⏰</span> Empty every 8-12 hours, rinse, and reinsert.</li>
                            <li><span class="emoji-large">🫧</span> Sterilize after each period.</li>
                        </ol>
                        <p style="color:var(--purple-dark);font-weight:600;">Tip: Practice makes perfect! It may take a few cycles to get comfortable.</p>
                    </div>
                </div>
            </div>

            <div class="accordion-item" onclick="toggleAccordion(this)">
                <div class="accordion-header">
                    <span>🩺 Understanding PCOS/PCOD</span>
                    <span class="accordion-icon">▼</span>
                </div>
                <div class="accordion-content">
                    <div class="accordion-content-inner">
                        <p><b>What's the difference between PCOS and PCOD?</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">⚕️</span> <b>PCOD (Polycystic Ovarian Disease):</b> A condition where ovaries produce immature eggs that turn into cysts</li>
                            <li><span class="emoji-large">🩺</span> <b>PCOS (Polycystic Ovary Syndrome):</b> A metabolic disorder affecting hormone production and insulin resistance</li>
                        </ul>
                        
                        <p style="margin-top:15px;"><b>Common Signs to Watch For:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">📅</span> Irregular periods (longer than 35 days or fewer than 8 cycles per year)</li>
                            <li><span class="emoji-large">⚖️</span> Unexplained weight gain, especially around the midsection</li>
                            <li><span class="emoji-large">🦱</span> Excessive hair growth on face, chest, or back (hirsutism)</li>
                            <li><span class="emoji-large">🧴</span> Thinning hair or male-pattern baldness</li>
                            <li><span class="emoji-large">💊</span> Difficulty getting pregnant</li>
                            <li><span class="emoji-large">🍬</span> Strong sugar cravings and fatigue after eating</li>
                        </ul>
                        
                        <p style="margin-top:15px;"><b>Management Tips:</b></p>
                        <ul style="padding-left: 18px;">
                            <li><span class="emoji-large">🥗</span> Follow a low-glycemic diet rich in fiber</li>
                            <li><span class="emoji-large">🏃‍♀️</span> Regular exercise, especially strength training and cardio</li>
                            <li><span class="emoji-large">😴</span> Maintain good sleep hygiene (7-9 hours per night)</li>
                            <li><span class="emoji-large">🧘‍♀️</span> Practice stress management techniques</li>
                            <li><span class="emoji-large">💊</span> Consider supplements like inositol, vitamin D, and omega-3</li>
                        </ul>
                        
                        <p style="color:var(--pink-dark);font-weight:600;margin-top:15px;">Remember: Early diagnosis and lifestyle changes can significantly improve symptoms and long-term health outcomes.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">💡 Daily Tips</h2>
        <div class="carousel">
            <button class="carousel-control prev" onclick="prevSlide()">❮</button>
            <div class="carousel-inner" id="carousel-inner">
                <div class="carousel-item">
                    <img src="https://img.icons8.com/color/96/000000/water-bottle.png" alt="Hydration" style="height:60px;margin-bottom:10px;">
                    <h3>Hydration is Key</h3>
                    <p>Drink plenty of water during your period to help reduce bloating and fatigue.</p>
                </div>
                <div class="carousel-item">
                    <img src="https://img.icons8.com/color/96/000000/sanitary-pad.png" alt="Pad" style="height:60px;margin-bottom:10px;">
                    <h3>Regular Changes</h3>
                    <p>Change your pad or tampon every 4-6 hours to maintain hygiene and prevent infections.</p>
                </div>
                <div class="carousel-item">
                    <img src="https://img.icons8.com/color/96/000000/leggings.png" alt="Clothing" style="height:60px;margin-bottom:10px;">
                    <h3>Comfortable Clothing</h3>
                    <p>Wear loose, comfortable clothing during your period to reduce discomfort and irritation.</p>
                </div>
                <div class="carousel-item">
                    <img src="https://img.icons8.com/color/96/000000/spinach.png" alt="Healthy Snacks" style="height:60px;margin-bottom:10px;">
                    <h3>Healthy Snacks</h3>
                    <p>Choose iron-rich foods like spinach and nuts to replenish what you lose during menstruation.</p>
                </div>
                <div class="carousel-item">
                    <img src="https://img.icons8.com/color/96/000000/yoga.png" alt="Exercise" style="height:60px;margin-bottom:10px;">
                    <h3>Gentle Exercise</h3>
                    <p>Light exercise like walking or yoga can help alleviate cramps and boost your mood.</p>
                </div>
            </div>
            <button class="carousel-control next" onclick="nextSlide()">❯</button>
        </div>
    </div>

    <div class="section">
        <h2 class="section-title">🩺 PCOD/PCOS Awareness</h2>
        <p style="color: var(--text-light); margin-bottom: 20px;">
            Polycystic Ovary Syndrome (PCOS) affects 1 in 10 women of reproductive age. Learn about the common symptoms and take our screening if you're concerned.
        </p>
          <div class="pcos-section-grid">
            <!-- PCOS Symptoms Chart -->
            <div class="pcos-chart-container">
                <h3 style="margin-bottom: 15px; color: var(--text-dark);">📊 Your PCOS Risk Assessment</h3>
                <div style="position: relative; height: 300px;">
                    <canvas id="pcosChart" width="400" height="300"></canvas>
                </div>
                <div style="margin-top: 15px; font-size: 0.9em; color: var(--text-light);">
                    {% if has_survey_data %}
                        <p><em>Chart shows your personalized PCOS risk factors based on your survey responses</em></p>
                    {% else %}
                        <p><em>Complete the survey to see your personalized risk assessment</em></p>
                    {% endif %}
                </div>
            </div>
            
            <!-- PCOS Survey Form -->
            <div class="pcos-survey-container">
                <h3 style="margin-bottom: 15px; color: var(--text-dark);">🔍 PCOS Screening Survey</h3>
                
                {% if has_survey_data %}
                    <div class="survey-status survey-completed">
                        ✓ Survey Completed - Results shown in chart
                    </div>
                    <p style="font-size: 14px; color: var(--text-light); margin-bottom: 15px;">
                        You can retake the survey anytime to update your assessment.
                    </p>
                {% else %}
                    <div class="survey-status survey-pending">
                        ⚠️ Survey Pending - Complete for personalized insights
                    </div>
                {% endif %}

                <form method="POST" action="{{ url_for('survey') }}" class="pcos-survey-form">
                    <!-- Quick Age Question -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Age:</label>
                        <input type="number" class="pcos-form-control" name="q1" required min="10" max="60" 
                               value="{{ survey.q1_age if survey else '' }}" placeholder="Enter your age">
                    </div>

                    <!-- Period Regularity -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Are your periods regular?</label>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q5" value="Regular" 
                                   {{ 'checked' if survey and survey.q5_period_regularity == 'Regular' else '' }}>
                            <label class="pcos-form-check-label">Regular (every 25–35 days)</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q5" value="Irregular"
                                   {{ 'checked' if survey and survey.q5_period_regularity == 'Irregular' else '' }}>
                            <label class="pcos-form-check-label">Irregular (too early or late)</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q5" value="Missed"
                                   {{ 'checked' if survey and survey.q5_period_regularity == 'Missed' else '' }}>
                            <label class="pcos-form-check-label">Missed periods for months</label>
                        </div>
                    </div>

                    <!-- Hair Growth -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Excessive facial/body hair growth?</label>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q6" value="Yes"
                                   {{ 'checked' if survey and survey.q6_hair_growth == 'Yes' else '' }}>
                            <label class="pcos-form-check-label">Yes</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q6" value="No"
                                   {{ 'checked' if survey and survey.q6_hair_growth == 'No' else '' }}>
                            <label class="pcos-form-check-label">No</label>
                        </div>
                    </div>

                    <!-- Acne -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Frequent or severe acne?</label>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q7" value="Yes"
                                   {{ 'checked' if survey and survey.q7_acne == 'Yes' else '' }}>
                            <label class="pcos-form-check-label">Yes</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q7" value="No"
                                   {{ 'checked' if survey and survey.q7_acne == 'No' else '' }}>
                            <label class="pcos-form-check-label">No</label>
                        </div>
                    </div>

                    <!-- Weight Gain -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Unexplained weight gain?</label>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q9" value="Yes"
                                   {{ 'checked' if survey and survey.q9_weight_gain == 'Yes' else '' }}>
                            <label class="pcos-form-check-label">Yes</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q9" value="No"
                                   {{ 'checked' if survey and survey.q9_weight_gain == 'No' else '' }}>
                            <label class="pcos-form-check-label">No</label>
                        </div>
                    </div>

                    <!-- Sugar Cravings -->
                    <div class="pcos-form-group">
                        <label class="pcos-form-label">Extreme fatigue after eating or sugar cravings?</label>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q10" value="Yes"
                                   {{ 'checked' if survey and survey.q10_sugar_craving == 'Yes' else '' }}>
                            <label class="pcos-form-check-label">Yes</label>
                        </div>
                        <div class="pcos-form-check">
                            <input class="pcos-form-check-input" type="radio" name="q10" value="No"
                                   {{ 'checked' if survey and survey.q10_sugar_craving == 'No' else '' }}>
                            <label class="pcos-form-check-label">No</label>
                        </div>
                    </div>

                    <!-- Hidden fields for required survey questions -->
                    <input type="hidden" name="q2" value="{{ 'today' if not survey else (survey.q2_last_period.strftime('%d %b %Y') if survey.q2_last_period else 'today') }}">
                    <input type="hidden" name="q3" value="{{ survey.q3_period_duration if survey else '5-7 days' }}">
                    <input type="hidden" name="q4" value="{{ survey.q4_cycle_length if survey else '21–35 days' }}">
                    <input type="hidden" name="q8" value="{{ survey.q8_hair_thinning if survey else 'No' }}">
                    <input type="hidden" name="q11" value="{{ survey.q11_family_history if survey else 'Not Sure' }}">
                    <input type="hidden" name="q12" value="{{ survey.q12_fertility if survey else 'Not trying yet' }}">
                    <input type="hidden" name="q13" value="{{ survey.q13_mood_swings if survey else 'Occasionally' }}">

                    <button type="submit" class="pcos-submit-btn">
                        {{ 'Update Assessment' if has_survey_data else 'Complete Assessment' }}
                    </button>
                </form>

                <div style="text-align: center; margin-top: 15px;">
                    <a href="/survey" class="pcos-survey-link" style="font-size: 14px; padding: 8px 16px;">
                        Take Full Detailed Survey 📋
                    </a>
                </div>
            </div>
        </div>

        <!-- PCOS Information Panel -->
        <div class="pcos-info-container">
            <h3 style="margin-bottom: 15px; color: var(--text-dark);">🔍 What is PCOS?</h3>
            <div style="color: var(--text-light); line-height: 1.6;">
                <p><strong>PCOS</strong> is a hormonal disorder that affects ovaries and can cause:</p>
                <ul style="margin: 15px 0; padding-left: 20px;">
                    <li>Irregular or missed periods</li>
                    <li>Excess androgen (male hormone) levels</li>
                    <li>Multiple cysts on ovaries</li>
                    <li>Difficulty getting pregnant</li>
                    <li>Weight gain or difficulty losing weight</li>
                </ul>

                <div style="background: white; border-radius: 12px; padding: 15px; margin-top: 20px; border-left: 4px solid var(--pink-dark);">
                    <p style="margin: 0; font-weight: 600; color: var(--text-dark);">
                        📝 Early detection is key! If you experience multiple symptoms, consider taking our PCOS screening survey.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Phase Details as HTML for modal
        const phaseModalData = [
            `<h3><span class='emoji-large'>🩸</span>Menstrual Phase</h3>
            <p><strong>What's happening:</strong> Your uterus sheds its lining, resulting in menstrual bleeding.</p>
            <ul>
                <li><span class='emoji-large'>💧</span> <b>Stay hydrated</b> to help reduce bloating and fatigue.</li>
                <li><span class='emoji-large'>🌿</span> <b>Eat iron-rich foods</b> (spinach, nuts, beans) to replenish your body.</li>
                <li><span class='emoji-large'>🔥</span> <b>Use a heat pad</b> for cramps and lower back pain.</li>
                <li><span class='emoji-large'>🧘‍♀️</span> <b>Gentle yoga</b> or stretching can help relieve discomfort.</li>
            </ul>
            <p><strong>Hygiene:</strong> Change your pad/tampon every 4-6 hours. Use breathable cotton underwear.</p>`,
            `<h3><span class='emoji-large'>🌱</span>Follicular Phase</h3>
            <p><strong>What's happening:</strong> Your body prepares for ovulation by developing follicles in the ovaries.</p>
            <ul>
                <li><span class='emoji-large'>💪</span> <b>Try new workouts</b> – your energy is rising!</li>
                <li><span class='emoji-large'>🥗</span> <b>Eat protein & healthy fats</b> for hormone support.</li>
                <li><span class='emoji-large'>💧</span> <b>Stay hydrated</b> to support cervical mucus production.</li>
            </ul>`,
            `<h3><span class='emoji-large'>🥚</span>Ovulation Phase</h3>
            <p><strong>What's happening:</strong> An egg is released from the ovary and travels down the fallopian tube.</p>
            <ul>
                <li><span class='emoji-large'>🔍</span> <b>Notice changes</b> in cervical mucus (egg-white texture is normal).</li>
                <li><span class='emoji-large'>🩲</span> <b>Wear cotton underwear</b> for comfort.</li>
                <li><span class='emoji-large'>🍒</span> <b>Eat anti-inflammatory foods</b> (berries, turmeric, ginger).</li>
            </ul>`,
            `<h3><span class='emoji-large'>🌕</span>Luteal Phase</h3>
            <p><strong>What's happening:</strong> The empty follicle produces progesterone to prepare the uterus for possible pregnancy.</p>
            <ul>
                <li><span class='emoji-large'>🥦</span> <b>Eat magnesium-rich foods</b> (dark chocolate, leafy greens) for mood.</li>
                <li><span class='emoji-large'>🧘‍♀️</span> <b>Practice stress-reduction</b> (meditation, deep breathing).</li>
                <li><span class='emoji-large'>🚶‍♀️</span> <b>Gentle walks</b> can help with PMS symptoms.</li>
            </ul>`
        ];

        // Remove duplicate openPhaseModal and closePhaseModal definitions
        function openPhaseModal(index) {
            document.getElementById('phase-modal-body').innerHTML = phaseModalData[index];
            document.getElementById('phase-modal-bg').classList.add('active');
        }
        function closePhaseModal() {
            document.getElementById('phase-modal-bg').classList.remove('active');
        }
        // Optional: Close modal on background click
        document.getElementById('phase-modal-bg').addEventListener('click', function(e) {
            if (e.target === this) closePhaseModal();
        });

        // Accordion Toggle
        function toggleAccordion(item) {
            item.classList.toggle('active');
        }

        // Carousel Functionality
        let currentSlide = 0;
        const carouselInner = document.getElementById('carousel-inner');
        const totalSlides = document.querySelectorAll('.carousel-item').length;

        function updateCarousel() {
            carouselInner.style.transform = `translateX(-${currentSlide * 100}%)`;
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % totalSlides;
            updateCarousel();
        }

        function prevSlide() {
            currentSlide = (currentSlide - 1 + totalSlides) % totalSlides;
            updateCarousel();
        }

        // Auto-advance carousel every 5 seconds
        setInterval(nextSlide, 5000);

        // Only keep PCOS chart and related code
        function createPCOSChart() {
            var ctx = document.getElementById('pcosChart').getContext('2d');
            // Output JS boolean and object literals from Jinja
            var hasSurveyData = {{ has_survey_data | tojson | safe }};
            var surveyStats = {{ survey_stats | tojson if has_survey_data else '{}' | safe }};
            
            let chartLabels, chartData, chartColors;
            
            if (hasSurveyData) {
                // Filter out symptoms that the user doesn't have (value = 0)
                const activeSymptoms = Object.entries(surveyStats).filter(([key, value]) => value > 0);
                
                if (activeSymptoms.length > 0) {
                    chartLabels = activeSymptoms.map(([key, value]) => key);
                    chartData = activeSymptoms.map(([key, value]) => value);
                    chartColors = [
                        'rgba(255, 140, 199, 0.8)',  // Pink
                        'rgba(178, 140, 255, 0.8)',  // Purple
                        'rgba(255, 182, 193, 0.8)',  // Light Pink
                        'rgba(221, 160, 221, 0.8)',  // Plum
                        'rgba(255, 215, 0, 0.8)',    // Gold
                        'rgba(152, 251, 152, 0.8)',   // Light Green
                        'rgba(255, 165, 0, 0.8)',    // Orange
                        'rgba(173, 216, 230, 0.8)',  // Light Blue
                        'rgba(240, 128, 128, 0.8)'   // Light Coral
                    ].slice(0, activeSymptoms.length);
                } else {
                    // User has no PCOS symptoms - show positive message
                    chartLabels = ['No Risk Factors Detected'];
                    chartData = [100];
                    chartColors = ['rgba(152, 251, 152, 0.8)']; // Green for good health
                }
            } else {
                // Show generic PCOS prevalence data
                chartLabels = [
                    'Irregular Periods',
                    'Weight Gain',
                    'Excessive Hair',
                    'Acne',
                    'Hair Thinning',
                    'Sugar Cravings'
                ];
                chartData = [85, 70, 60, 55, 45, 65];
                chartColors = [
                    'rgba(255, 140, 199, 0.8)',  // Pink
                    'rgba(178, 140, 255, 0.8)',  // Purple
                    'rgba(255, 182, 193, 0.8)',  // Light Pink
                    'rgba(221, 160, 221, 0.8)',  // Plum
                    'rgba(255, 215, 0, 0.8)',    // Gold
                    'rgba(152, 251, 152, 0.8)'   // Light Green
                ];
            }
            
            const pcosData = {
                labels: chartLabels,
                datasets: [{
                    label: hasSurveyData ? 'Your Risk Level (%)' : 'Prevalence (%)',
                    data: chartData,
                    backgroundColor: chartColors,
                    borderColor: chartColors.map(color => color.replace('0.8', '1')),
                    borderWidth: 2
                }]
            };

            new Chart(ctx, {
                type: 'doughnut',
                data: pcosData,
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: {
                                    family: 'Poppins'
                                }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.95)',
                            titleColor: '#6E5B9A',
                            bodyColor: '#4A4A4A',
                            borderColor: '#E8E0FF',
                            borderWidth: 1,
                            padding: 12,
                            cornerRadius: 8
                        }
                    },
                    animation: {
                        animateRotate: true,
                        duration: 1500
                    }
                }
            });
        }

        // Initialize PCOS chart when page loads
        window.addEventListener('DOMContentLoaded', function() {
            // ...existing code...
            
            if (document.getElementById('pcosChart')) {
                createPCOSChart();
            }
        });
    </script>
    <script src="/static/js/chart.min.js"></script>
    <script>
    // Symptom Log Chart Rendering for Education Page (Backend version)
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof Chart === 'undefined') return;

        // Helper: Get last N days as YYYY-MM-DD
        function getDateLabels(days) {
            const labels = [];
            const today = new Date();
            for (let i = days - 1; i >= 0; i--) {
                const d = new Date(today);
                d.setDate(today.getDate() - i);
                labels.push(d.toISOString().slice(0, 10));
            }
            return labels;
        }

        // Aggregate logs by date
        function aggregateLogs(logs, dateLabels) {
            // For each date, count number of symptoms logged (or sum severity, etc.)
            const data = dateLabels.map(date => {
                const entry = logs.find(l => l.date === date);
                if (!entry) return 0;
                // Count number of non-empty fields (flow, mood, pain, notes)
                let count = 0;
                if (entry.flow_level) count++;
                if (entry.mood) count++;
                if (typeof entry.pain_level === 'number' && entry.pain_level > 0) count++;
                if (entry.notes && entry.notes.trim() !== '') count++;
                return count;
            });
            return data;
        }

        // Render Chart.js chart
        function renderSymptomChart(ctx, labels, data, label) {
            return new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels.map(l => l.slice(5)), // show MM-DD
                    datasets: [{
                        label: label,
                        data: data,
                        backgroundColor: 'rgba(255, 184, 209, 0.7)',
                        borderColor: 'rgba(110, 91, 154, 0.8)',
                        borderWidth: 1,
                        borderRadius: 6,
                        maxBarThickness: 32
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { display: false },
                        title: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: { stepSize: 1 }
                        }
                    }
                }
            });
        }

        // Fetch all symptom entries for the user from backend
        function fetchSymptomLogs(cb) {
            fetch('/api/symptom-logs')
                .then(r => r.json())
                .then(res => {
                    if (res.success && Array.isArray(res.data)) {
                        cb(res.data);
                    } else {
                        cb([]);
                    }
                })
                .catch(() => cb([]));
        }

        // Main logic
        function updateSymptomCharts() {
            fetchSymptomLogs(function(logs) {
                // Weekly
                const weekLabels = getDateLabels(7);
                const weekData = aggregateLogs(logs, weekLabels);
                // Monthly
                const monthLabels = getDateLabels(30);
                const monthData = aggregateLogs(logs, monthLabels);

                // Destroy previous charts if any
                if (window.weeklySymptomChartObj) window.weeklySymptomChartObj.destroy();
                if (window.monthlySymptomChartObj) window.monthlySymptomChartObj.destroy();

                const weekCtx = document.getElementById('weeklySymptomChart').getContext('2d');
                const monthCtx = document.getElementById('monthlySymptomChart').getContext('2d');
                window.weeklySymptomChartObj = renderSymptomChart(weekCtx, weekLabels, weekData, 'Symptoms Logged');
                window.monthlySymptomChartObj = renderSymptomChart(monthCtx, monthLabels, monthData, 'Symptoms Logged');
            });
        }

        // Initial render
        updateSymptomCharts();
    });
    </script>
    <!-- Include common sidebar JavaScript -->
    <script src="{{ url_for('static', filename='js/common-sidebar.js') }}"></script>
</body>
</html>